<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ai-Aè‚¡äº¤æ˜“æœºå™¨ A-share AI</title>
    <script src="config.js"></script>
    <script src="js/sw-helper.js"></script>
    <script src="js/cache-helper.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/socket.io/4.0.0/socket.io.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
            transform: scale(0.8);  
            transform-origin: top left;
            width: 125%;
            height: 125%;
            overflow-x: hidden;
        }
        .container {
            max-width: 100%;
            margin: 0 auto;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-shrink: 0;
        }
        .header h1 {
            text-align: left;
            margin: 0;
            font-size: 26px;
        }
        .header-nav {
            display: flex;
            gap: 24px;
            justify-content: center;
            flex: 1;
        }
        .header-nav a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
            font-size: 20px;
        }
        .header-nav a:hover {
            color: #764ba2;
        }
        .content-wrapper {
            display: flex;
            gap: 20px;
            flex: 1;
            min-height: 0;
        }
        .left-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
            min-height: 0;
        }
        .right-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }
        .chart-wrapper, .logs-container, .readme-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .chart-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 0;
        }
        .chart-wrapper h2 {
            margin-top: 0;
            flex-shrink: 0;
        }
        #performanceChart {
            width: 100%;
            height: 100%;
            max-height: none;
        }
        .lazy-load-container {
            flex: 1;
            position: relative;
            min-height: 0;
        }
        .logs-container {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-height: 0;
        }
        .logs-container h2 {
            margin-top: 0;
            flex-shrink: 0;
            text-align: left;
        }
        #logContainer {
            flex: 1;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 10px;
            font-family: monospace;
            font-size: 14px;
            text-align: left;
            min-height: 0;
        }
        .log-entry {
            margin: 5px 0;
            padding: 5px 0;
            border-bottom: 1px solid #eee;
            text-align: left;
        }
        .log-entry .timestamp {
            color: #666;
            margin-right: 10px;
        }
        .log-entry .level {
            display: inline-block;
            width: 70px;
            text-align: center;
            margin-right: 10px;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 12px;
        }
        .level.INFO { background-color: #d1ecf1; color: #0c5460; }
        .level.WARNING { background-color: #fff3cd; color: #856404; }
        .level.ERROR { background-color: #f8d7da; color: #721c24; }
        
        .readme-container {
            flex: 1;
            overflow-y: auto;
            min-height: 0;
        }
        .readme-container h1 {
            font-size: 1.8em;
            color: #333;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        .readme-container h2 {
            font-size: 1.4em;
            color: #444;
            margin-top: 25px;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }
        .readme-container h3 {
            font-size: 1.2em;
            color: #555;
            margin-top: 20px;
        }
        .readme-container ul {
            padding-left: 20px;
        }
        .readme-container li {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        .readme-container p {
            line-height: 1.6;
            color: #666;
            margin: 10px 0;
        }
        .readme-container code {
            background-color: #f8f8f8;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: monospace;
        }
        .readme-container blockquote {
            border-left: 4px solid #ddd;
            margin: 0;
            padding: 0 15px;
            color: #777;
        }
        .readme-container .email {
            font-weight: bold;
            color: #0066cc;
        }
        
        .lazy-load-container {
            position: relative;
            min-height: 200px;
        }
        
        .lazy-load-placeholder {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #666;
        }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Ai-Aè‚¡äº¤æ˜“æœºå™¨â€”â€”çœŸå®è´¦æˆ·ç§’çº§äº¤æ˜“ï¼›Aiè‡ªä¸»å†³ç­–ã€è‡ªæˆ‘å‘ç°ã€è‡ªæˆ‘è®­ç»ƒã€è‡ªæˆ‘è¿›åŒ–</h1>
            <div class="header-nav">
                <a href="index.html">å®æ—¶å†³ç­–æ—¥å¿—</a>
                <a href="portfolio.html">å®æ—¶æŠ•èµ„ç»„åˆ</a>
                <a href="reports/report.html">Aiå†å²æ’è¡Œ(åŸºé‡‘è¿ä½œ)</a>
                <a href="reportsall/report.html">Aiå†å²æ’è¡Œ(å…¨å¸‚åœº)</a>
            </div>
        </div>
        
        <div class="content-wrapper">
            <div class="left-column">
                <div class="chart-wrapper">
                    <h2>æ¨¡å‹æ”¶ç›Šæ›²çº¿ï¼ˆå®æ—¶æ•°æ®ï¼‰
                        <button id="toggleDataButton" style="float: right; margin-top: -5px; font-size: 14px;">æ˜¾ç¤ºå…¨éƒ¨æ•°æ®</button>
                    </h2>
                    <div class="lazy-load-container" id="chartContainer">
                        <div class="lazy-load-placeholder" id="chartPlaceholder">
                            <div class="loading-spinner"></div>
                            <p>æ­£åœ¨åŠ è½½å›¾è¡¨...</p>
                        </div>
                        <canvas id="performanceChart" style="display: none; width: 100%; height: 100%;"></canvas>
                    </div>
                </div>
                
                <div class="readme-container">
                    <h1>å¹»é“¶é‡åŒ–Aè‚¡AIäº¤æ˜“ç³»ç»ŸA-share-Ai</h1>

                    <p>åŸºäºå››å¤§å›½å†…å¤§æ¨¡å‹ï¼ˆå¹»é“¶è¶…iã€DeepSeekã€é€šä¹‰åƒé—®ã€è±†åŒ…ï¼‰çš„Aè‚¡è‡ªåŠ¨äº¤æ˜“ç³»ç»Ÿï¼Œæ”¯æŒå…¨å¸‚åœºé€‰è‚¡å’Œå®ç›˜äº¤æ˜“ã€‚</p>

                    <h2>åŠŸèƒ½ç‰¹æ€§</h2>

                    <p>ğŸ¯ è®©AIåœ¨Aè‚¡å¸‚åœºä¸­ä¸€å±•èº«æ‰‹ï¼Œè®©å¤šä¸ªå¤§è¯­è¨€æ¨¡å‹åœ¨Aè‚¡å…¨å¸‚åœºè‚¡ç¥¨ä¸­å®Œå…¨è‡ªä¸»å†³ç­–ã€åŒå°ç«æŠ€ï¼</p>

                    <p>ğŸ¯ æ¥å…¥Aè‚¡çœŸå®äº¤æ˜“è´¦æˆ·ï¼Œå®æ—¶å±•ç¤ºaiçœŸå®äº¤æ˜“è¿‡ç¨‹ï¼Œå®æ—¶+çœŸå®äº¤æ˜“è®©ç³»ç»Ÿæœ‰æ›´å¹¿é˜”çš„åº”ç”¨ç©ºé—´</p>

                    <p>ğŸ¯ å¤šæ¨¡å‹é›†æˆï¼šæ”¯æŒå¹»é“¶è¶…iã€DeepSeekã€é€šä¹‰åƒé—®ã€è±†åŒ…ç­‰å¤šç§å¤§è¯­è¨€æ¨¡å‹</p>

                    <p>ğŸ¯ ç­–ç•¥è¿›åŒ–ï¼šåŸºäºäº¤æ˜“è¡¨ç°ï¼ŒAIæ¨¡å‹èƒ½å¤Ÿä¸æ–­ä¼˜åŒ–è‡ªå·±çš„æŠ•èµ„ç­–ç•¥</p>

                    <p>â° ç§’çº§åˆ«å®ç›˜äº¤æ˜“æ”¯æŒ - æ¥å…¥å®ç›˜ç§’çº§ç²¾åº¦äº¤æ˜“</p>

                    <p>ğŸš€ æœåŠ¡éƒ¨ç½²ä¸å¹¶è¡Œæ‰§è¡Œ - éƒ¨ç½²ç”Ÿäº§æœåŠ¡ + å¹¶è¡Œæ¨¡å‹æ‰§è¡Œ</p>

                    <p>ğŸ¨ aiäº¤æ˜“é€»è¾‘å±•ç¤º - è¯¦ç»†çš„äº¤æ˜“æ—¥å¿—å¯è§†åŒ–ï¼ˆå®Œæ•´äº¤æ˜“è¿‡ç¨‹å±•ç¤ºï¼‰</p>

                    <p>ğŸ¯ æ ¸å¿ƒç‰¹è‰²: 100% AIè‡ªä¸»å†³ç­–ï¼Œé›¶äººå·¥å¹²é¢„ï¼Œaiç­–ç•¥è‡ªæˆ‘å‘ç°ã€è‡ªæˆ‘è®­ç»ƒã€è‡ªæˆ‘è¿›åŒ–</p>

                    <p>ğŸ¯ ç‰¹åˆ«åŠŸèƒ½ï¼šåœ¨äº¤æ˜“è¿‡ç¨‹ä¸­å¯æ·»åŠ å®æ—¶äººå·¥å¹²é¢„å’ŒAiè¿›è¡Œäº’åŠ¨ï¼ˆå¯é€‰ï¼‰ï¼Œé€‚åº”å¤§è§„æ¨¡æŠ•èµ„çš„çœŸå®åœºæ™¯</p>

                    <p>ğŸ¯ æ–°å¢äº†å¼‚æ­¥æ‰§è¡ŒåŠŸèƒ½ï¼Œæé«˜ç³»ç»Ÿè¿è¡Œé€Ÿåº¦</p>

                    <ul>
                        <li>ğŸ¤– <strong>4å¤§æ¨¡å‹å¹¶è¡Œ</strong>ï¼šå¹»é“¶è¶…iã€DeepSeekã€Qwené€šä¹‰åƒé—®ã€è±†åŒ…åŒæ—¶è¿è¡Œï¼Œæ¯”è¾ƒæ”¶ç›Š</li>
                        <li>ğŸ“ˆ <strong>å…¨å¸‚åœºé€‰è‚¡</strong>ï¼šAIè‡ªä¸»ä»å…¨å¸‚åœºé€‰æ‹©æœ‰æ½œåŠ›çš„è‚¡ç¥¨ï¼Œè‡ªå®šä¹‰è‚¡ç¥¨æ± ï¼ˆå¯é€‰ï¼‰</li>
                        <li>ğŸ’¹ <strong>å®æ—¶è¡Œæƒ…</strong>ï¼šé›†æˆå®æ—¶Aè‚¡æ•°æ®ï¼Œä¾›aiä½¿ç”¨å¹¶ç”¨äºå®é™…äº¤æ˜“</li>
                        <li>ğŸ’¹ <strong>å†å²è¡Œæƒ…+è´¢åŠ¡æ•°æ®</strong>ï¼šé›†æˆAè‚¡å†å²è¡Œæƒ…å’Œè´¢åŠ¡æ•°æ®ï¼Œä¾›aiåˆ†æå’Œè®­ç»ƒ</li>
                        <li>ğŸ¯ <strong>æ™ºèƒ½äº¤æ˜“</strong>ï¼šåŸºäºAIåˆ†æç”Ÿæˆä¹°å–ä¿¡å·å¹¶å…¨è‡ªåŠ¨æ‰§è¡Œäº¤æ˜“</li>
                        <li>ğŸŒˆ <strong>å¤šç§ç­–ç•¥</strong>ï¼šåŒ…æ‹¬è¶‹åŠ¿è·Ÿè¸ªã€å‡çº¿ç­–ç•¥ã€æŠ€æœ¯æŒ‡æ ‡ç­–ç•¥ã€é‡åŒ–å¥—åˆ©ç­–ç•¥ç­‰ï¼Œå®Œå…¨ç”±aiè‡ªåŠ¨é€‰æ‹©å¹¶ä¸æ–­è¿›åŒ–</li>
                        <li>ğŸ“Š <strong>å®æ—¶ç›‘æ§</strong>ï¼šUIç•Œé¢å®æ—¶æ˜¾ç¤ºæ”¶ç›Šæ›²çº¿å’Œäº¤æ˜“æ—¥å¿—</li>
                        <li>ğŸ”’ <strong>é£é™©æ§åˆ¶</strong>ï¼šå†…ç½®ä»“ä½æ§åˆ¶å’Œæ­¢æŸæœºåˆ¶</li>
                    </ul>

                    <h2>ğŸ“Š Aiç‚’è‚¡å¤§èµ›æ’è¡Œæ¦œã€å®æ—¶æ”¶ç›ŠåŠå†³ç­–æ—¥å¿—ã€å®æ—¶æŠ•èµ„ç»„åˆ</h2>

                    <div style="display: flex; flex-wrap: wrap; gap: 15px; margin: 20px 0;">
                        <a href="https://hyqibot.github.io/A-share-Ai/reports/report.html" target="_blank" style="display: inline-block; padding: 10px 20px; background-color: #007acc; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
                            ğŸ“ˆ Aiç‚’è‚¡å¤§èµ›å†å²æ’è¡Œæ¦œ(åŸºé‡‘è¿ä½œ)
                        </a>
                        <a href="https://hyqibot.github.io/A-share-Ai/reportsall/report.html" target="_blank" style="display: inline-block; padding: 10px 20px; background-color: #007acc; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
                            ğŸ“ˆ Aiç‚’è‚¡å¤§èµ›å†å²æ’è¡Œæ¦œ(å…¨å¸‚åœº)
                        </a>
                        <a href="https://hyqibot.github.io/A-share-Ai/" target="_blank" style="display: inline-block; padding: 10px 20px; background-color: #28a745; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
                            ğŸ¯ å®æ—¶æ”¶ç›ŠåŠå†³ç­–æ—¥å¿—
                        </a>
                        <a href="https://hyqibot.github.io/A-share-Ai/portfolio.html" target="_blank" style="display: inline-block; padding: 10px 20px; background-color: #fd7e14; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
                            ğŸ“Š å®æ—¶æŠ•èµ„ç»„åˆ
                        </a>
                    </div>

                    <h2>å®‰è£…ä½¿ç”¨</h2>

                    <ol>
                        <li><strong>å®‰è£…åŠå¯åŠ¨</strong><br>
                        é¡¹ç›®å·²æ‰“åŒ…æˆæ¡Œé¢exeè½¯ä»¶ï¼Œå¯ç›´æ¥ä¸‹è½½è¿è¡Œï¼Œæä¾›é•¿è¾¾3ä¸ªæœˆçš„å…è´¹å†…æµ‹ï¼Œä½¿ç”¨è€…æä¾›åé¦ˆè¢«é‡‡çº³ï¼Œå°†å¯è·å–ä¸“ä¸šçš„æŠ€æœ¯æ”¯æŒå’Œé•¿æœŸä½¿ç”¨æƒã€‚é¢„çº¦é‚®ç®±ï¼š<span class="email">hyqi@tradey.dpdns.org</span>ï¼Œè¯·Staré¡¹ç›®ï¼ˆç‚¹å³ä¸Šäº”è§’æ˜ŸStarï¼‰åï¼Œå‘é€æ‚¨çš„è”ç³»æ–¹å¼ã€ç®€çŸ­ä»‹ç»å¹¶è¯´æ˜ä½¿ç”¨ç›®çš„ï¼Œæˆ‘ä»¬å°†æ ¹æ®æ‚¨çš„é‚®ä»¶å†…å®¹å†³å®šæ˜¯å¦å®‰æ’å†…æµ‹è¯•ç”¨ï¼Œå¦‚æ‚¨è·å¾—å†…æµ‹èµ„æ ¼å°†åœ¨3-5ä¸ªå·¥ä½œæ—¥å·¦å³é‚®ä»¶é€šçŸ¥ã€‚</li>
                        <li><strong>å¯åŠ¨æ–¹æ³•å¾ˆç®€å•ï¼šå‚»ç“œå¼ï¼Œæ— éœ€pythonåŸºç¡€</strong><br>
                        ä¸‹è½½Releaseså®‰è£…åŒ…ï¼Œè§£å‹ï¼Œå°†user_config.json.exampleé‡å‘½åä¸ºuser_config.jsonï¼Œå¡«å†™å‚æ•°<br>
                        éœ€è¦ç”¨åˆ°çš„å‚æ•°æœ‰å‡ ç±»ï¼š1ï¼‰çœŸå®äº¤æ˜“è´¦æˆ·çš„å®‰è£…è·¯å¾„ã€è´¦å·ï¼Œå¯æ¥å…¥ä¸“ä¸šäº¤æ˜“apiï¼ˆå¦è¯¢å®˜é‚®ï¼‰ï¼Œå…¼å®¹å„å¤§åˆ¸å•†çš„QMTå’ŒåŒèŠ±é¡ºäº¤æ˜“ï¼›2ï¼‰è‡ªé€‰è‚¡ç¥¨æ± é€šè¾¾ä¿¡æœ¬åœ°è·¯å¾„ï¼›3ï¼‰deepseekç­‰å¤§æ¨¡å‹api-keyï¼›4ï¼‰licenceï¼šhyqibot<br>
                        å¡«å¥½å‚æ•°ä¿å­˜ï¼Œå³é”®ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œè§£å‹å¥½çš„exeæ–‡ä»¶ï¼Œå›¾å½¢ç•Œé¢ä¸Šç‚¹å‡»å¯åŠ¨äº¤æ˜“å³å¯ã€‚</li>
                    </ol>

                    <h2>æ ¸å¿ƒé£è·ƒï¼šçœŸæ­£çš„AIè‡ªæˆ‘å‘ç°</h2>

                    <ol>
                        <li><strong>ä»ç©ºç™½æˆ–ä½¿ç”¨è€…è®¾å®šçš„é£æ ¼å¼€å§‹</strong><br>
                        æ‰€æœ‰AIåˆå§‹å¯ä»¥éƒ½æ˜¯"è‡ªé€‚åº”æŠ•èµ„è€…"<br>
                        ä¹Ÿå¯ä»¥é¢„è®¾æŠ•èµ„é£æ ¼<br>
                        é€šè¿‡å®è·µå‘ç°è‡ªå·±çš„ç‰¹é•¿</li>
                        <li><strong>è‡ªæˆ‘åæ€æœºåˆ¶</strong><br>
                        å®šæœŸå›é¡¾æŠ•èµ„è¡¨ç°<br>
                        åˆ†æä»€ä¹ˆç­–ç•¥å¯¹è‡ªå·±æœ‰æ•ˆ<br>
                        ä¸»åŠ¨è°ƒæ•´æŠ•èµ„å“²å­¦</li>
                        <li><strong>é£æ ¼è¿›åŒ–</strong><br>
                        è®°å½•é£æ ¼å˜åŒ–è½¨è¿¹<br>
                        åŸºäºè¡¨ç°è°ƒæ•´é£é™©åå¥½<br>
                        é€æ­¥å½¢æˆç¨³å®šçš„æŠ•èµ„äººæ ¼</li>
                        <li><strong>çœŸæ­£çš„å·®å¼‚æ€§</strong><br>
                        ç°åœ¨4ä¸ªAIå°†ï¼š<br>
                        è‡ªä¸»å‘ç°é£æ ¼ï¼šæ¯”å¦‚ï¼Œå¹»é“¶è¶…iæœ€æ˜ç™½åšå¼ˆç²¾é«“ï¼ŒDeepSeekå¯èƒ½å‘ç°è‡ªå·±æ“…é•¿é‡åŒ–ï¼ŒQwenæˆ–è€…åå¥½ä»·å€¼æŠ•èµ„<br>
                        ä¸åŒçš„è¿›åŒ–è·¯å¾„ï¼šæ¯ä¸ªAIåŸºäºè‡ªèº«ç‰¹è´¨å’Œå¸‚åœºåé¦ˆå½¢æˆç‹¬ç‰¹é£æ ¼<br>
                        åŠ¨æ€è°ƒæ•´ï¼šæ ¹æ®å¸‚åœºç¯å¢ƒå˜åŒ–è°ƒæ•´ç­–ç•¥<br>
                        çœŸæ­£çš„ä¸ªæ€§ï¼šå‘å±•å‡ºåæ˜ å…¶"æ€§æ ¼"çš„æŠ•èµ„å“²å­¦</li>
                    </ol>

                    <h3>é¢„æœŸç»“æœ</h3>
                    <p>æ‚¨å°†çœ‹åˆ°ï¼š</p>

                    <p>çœŸæ­£çš„AIä¸ªæ€§ï¼šæ¯ä¸ªAIå‘å±•å‡ºç‹¬ç‰¹çš„æŠ•èµ„èº«ä»½</p>

                    <p>åŠ¨æ€çš„é£æ ¼è¿›åŒ–ï¼šæŠ•èµ„é£æ ¼ä¼šéšç€ç»éªŒç§¯ç´¯è€Œæ”¹å˜</p>

                    <p>åŸºäºè¡¨ç°çš„è°ƒæ•´ï¼šæˆåŠŸçš„ç­–ç•¥è¢«ä¿ç•™ï¼Œå¤±è´¥çš„è¢«æ·˜æ±°</p>

                    <p>ä¸å¯é¢„æµ‹çš„ç»“æœï¼šæ— æ³•é¢„å…ˆçŸ¥é“å“ªä¸ªAIä¼šå‘å±•å‡ºä»€ä¹ˆé£æ ¼</p>

                    <p>è¿™æ ·è®¾è®¡åï¼Œæ‚¨å°†è§è¯çœŸæ­£çš„"AIæŠ•èµ„ç»ç†æˆé•¿å²"ï¼Œè€Œä¸æ˜¯é¢„å…ˆç¼–æ’çš„è¡¨æ¼”ã€‚æ¯ä¸ªAIéƒ½æœ‰æœºä¼šæ‰¾åˆ°æœ€é€‚åˆè‡ªå·±çš„æŠ•èµ„é“è·¯ï¼</p>

                    <blockquote>
                    <h3>ğŸ§  å¹»é“¶è¶…iï¼ˆHYQiï¼‰çš„æ„¿æ™¯</h3>

                    <p>æˆ‘ä»¬æ­£ä»¥å®æ—¶çš„çœŸå®äº¤æ˜“ç¯å¢ƒå»è®­ç»ƒAiï¼Œä»¥æ­¤æ¥æµ‹è¯•å¹¶æé«˜Aiçš„æ™ºæ…§ï¼Œè¿ç”¨å¼€æ”¾å¼å­¦ä¹ ã€å¤§è§„æ¨¡å¼ºåŒ–å­¦ä¹ ç­‰æŠ€æœ¯æ¥é©¾é©­å…¶å¤æ‚æ€§ã€‚</p>

                    <p>å¿ƒæ€€æ­¤å¿µï¼Œæˆ‘ä»¬æ­£å¹¿çº³è´¤æ‰ï¼Œæ‹›å‹Ÿèµ„æ·±aiç ”ç©¶å‘˜ã€åˆ›ä¸šä¼™ä¼´ä¸æ€ç»´ç ´å±€è€…ã€‚</p>

                    <p>å¦‚æœæ‚¨æ¸´æœ›ä¸ºç°å®ä¸–ç•Œæ‰“é€ Alpha-HYQiï¼Œæ¬¢è¿ä¸æˆ‘ä»¬æºæ‰‹ã€‚ç®€å†è¯·å‘é€è‡³ï¼šhyqi@tradey.dpdns.org</p>

                    <p>"èµ„æœ¬é…ç½®ï¼Œæ˜¯aiæ™ºæ…§æ¥å—çœŸç†æ£€éªŒçš„æœ€ä½³è¯•é‡‘çŸ³"ã€‚</p>

                    <p>â€”â€”â€”å¹»é“¶è¶…iä¸æ‚¨å…±å‹‰</p>
                    </blockquote>
                </div>
            </div>
            
            <div class="right-column">
                <div class="logs-container">
                    <h2>è¿è¡Œæ—¥å¿—</h2>
                    <div id="logContainer"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ä»é…ç½®è·å– API åœ°å€
        // æ³¨æ„ï¼šTailscale Funnel URL æ ¼å¼é€šå¸¸æ˜¯ https://xxx.ts.netï¼ˆå·²åŒ…å«ç«¯å£æ˜ å°„ï¼‰
        const API_BASE = window.API_CONFIG ? window.API_CONFIG.baseUrl : 'http://localhost:4000';
        
        // Socket.IO æœåŠ¡å™¨åœ°å€
        // Tailscale Funnel é€šè¿‡ HTTPS æš´éœ² 4000 ç«¯å£ï¼ŒSocket.IO ä¼šè‡ªåŠ¨ä½¿ç”¨ WSSï¼ˆWebSocket Secureï¼‰
        let SOCKET_URL = API_BASE;
        if (!SOCKET_URL.startsWith('http')) {
            // å¦‚æœ URL æ²¡æœ‰åè®®ï¼Œæ·»åŠ  http://
            SOCKET_URL = `http://${SOCKET_URL}`;
        }
        
        // æ£€æŸ¥æ˜¯å¦æ˜¯ Tailscale Funnel URLï¼ˆ.ts.net åŸŸåï¼‰
        const isTailscaleFunnel = SOCKET_URL.includes('.ts.net');
        const isLocalhost = SOCKET_URL.includes('localhost') || SOCKET_URL.includes('127.0.0.1');
        
        console.log('ğŸ”§ API é…ç½®:', {
            API_BASE: API_BASE,
            SOCKET_URL: SOCKET_URL,
            isTailscaleFunnel: isTailscaleFunnel,
            isLocalhost: isLocalhost
        });
        
        // åˆå§‹åŒ–SocketIOè¿æ¥ï¼ˆå¦‚æœå¯ç”¨ï¼‰
        // Tailscale Funnel æ”¯æŒ WebSocketï¼Œå¯ä»¥å®ç°å®æ—¶æ¨é€
        let socket = null;
        let useSocketIO = false;
        let chart = null;
        
        try {
            // Socket.IO åº“å¯ç”¨ä¸”ä¸æ˜¯æœ¬åœ°åœ°å€æ—¶ï¼Œå°è¯•è¿æ¥
            if (typeof io !== 'undefined' && !isLocalhost) {
                console.log('ğŸš€ å°è¯•è¿æ¥ Socket.IO æœåŠ¡å™¨:', SOCKET_URL);
                
                socket = io(SOCKET_URL, {
                    reconnection: true,
                    reconnectionDelay: 1000,
                    reconnectionDelayMax: 5000,
                    reconnectionAttempts: 10, // Tailscale å¯èƒ½éœ€è¦æ›´å¤šé‡è¯•
                    transports: ['websocket', 'polling'], // ä¼˜å…ˆ WebSocketï¼Œå¤±è´¥æ—¶é™çº§åˆ° polling
                    timeout: 10000, // Tailscale å¯èƒ½éœ€è¦æ›´é•¿çš„è¶…æ—¶
                    autoConnect: true,
                    forceNew: false,
                    // å¯¹äº HTTPS/WSSï¼Œç¡®ä¿æ­£ç¡®å¤„ç†è¯ä¹¦
                    rejectUnauthorized: false // Tailscale ä½¿ç”¨è‡ªç­¾åè¯ä¹¦æ—¶éœ€è¦
                });
                
                // è¿æ¥æˆåŠŸ
                socket.on('connect', () => {
                    useSocketIO = true;
                    console.log('âœ… Socket.IO è¿æ¥æˆåŠŸï¼');
                    console.log('   - æœåŠ¡å™¨åœ°å€:', SOCKET_URL);
                    console.log('   - ä¼ è¾“æ–¹å¼:', socket.io.engine.transport.name);
                    console.log('   - ä½¿ç”¨å®æ—¶æ¨é€æ¨¡å¼');
                });
                
                // è¿æ¥å¤±è´¥
                socket.on('connect_error', (error) => {
                    useSocketIO = false;
                    console.warn('âš ï¸ Socket.IO è¿æ¥å¤±è´¥ï¼Œé™çº§åˆ° HTTP è½®è¯¢æ¨¡å¼');
                    console.warn('   é”™è¯¯ä¿¡æ¯:', error.message);
                    console.warn('   å°†ç»§ç»­ä½¿ç”¨ HTTP è½®è¯¢è·å–æ•°æ®');
                });
                
                // æ–­å¼€è¿æ¥
                socket.on('disconnect', (reason) => {
                    useSocketIO = false;
                    console.warn('âš ï¸ Socket.IO æ–­å¼€è¿æ¥:', reason);
                    console.warn('   å°†åˆ‡æ¢åˆ° HTTP è½®è¯¢æ¨¡å¼');
                });
                
                // æ¥æ”¶æœåŠ¡å™¨ç¡®è®¤
                socket.on('connection_success', (data) => {
                    console.log('âœ… æœåŠ¡å™¨ç¡®è®¤è¿æ¥:', data);
                });
                
                // æ¥æ”¶æ€§èƒ½æ•°æ®æ›´æ–°
                socket.on('performance_update', (data) => {
                    if (chart) {
                        updatePerformanceChart(chart, data);
                    }
                });
                
                // æ¥æ”¶æ—¥å¿—æ›´æ–°ï¼ˆå®æ—¶æ¨é€ï¼‰
                socket.on('new_log', (data) => {
                    const logContainer = document.getElementById('logContainer');
                    if (logContainer) {
                        addLogEntry(logContainer, data);
                        // é‡ç½®è½®è¯¢è®¡æ•°å™¨ï¼ˆå¦‚æœSocketIOæ­£å¸¸ï¼Œå°±ä¸éœ€è¦è½®è¯¢ï¼‰
                        if (typeof lastLogPollTime !== 'undefined') {
                            lastLogPollTime = Date.now();
                        }
                    }
                });
            } else if (isLocalhost) {
                console.log('â„¹ï¸ æ£€æµ‹åˆ°æœ¬åœ°åœ°å€ï¼ŒSocket.IO å°†è¿æ¥åˆ°æœ¬åœ°æœåŠ¡å™¨');
                // æœ¬åœ°ç¯å¢ƒä¹Ÿå°è¯•è¿æ¥
                socket = io(SOCKET_URL, {
                    reconnection: true,
                    transports: ['websocket', 'polling']
                });
                socket.on('connect', () => {
                    useSocketIO = true;
                    console.log('âœ… æœ¬åœ° Socket.IO è¿æ¥æˆåŠŸ');
                });
                socket.on('connect_error', () => {
                    useSocketIO = false;
                    console.warn('âš ï¸ æœ¬åœ° Socket.IO è¿æ¥å¤±è´¥ï¼Œä½¿ç”¨ HTTP è½®è¯¢');
                });
            } else {
                console.log('â„¹ï¸ Socket.IO åº“æœªåŠ è½½ï¼Œä½¿ç”¨ HTTP è½®è¯¢æ¨¡å¼');
            }
        } catch (e) {
            console.warn('âš ï¸ Socket.IO åˆå§‹åŒ–å¤±è´¥ï¼Œä½¿ç”¨ HTTP è½®è¯¢æ¨¡å¼:', e.message);
        }
        
        // ç­‰å¾…Chart.jsåŠ è½½å®Œæˆåå†åˆå§‹åŒ–å›¾è¡¨
        function initChart() {
            if (typeof Chart === 'undefined') {
                console.log('Chart.jsæœªåŠ è½½å®Œæˆï¼Œç­‰å¾…ä¸­...');
                setTimeout(initChart, 1000);
                return;
            }
            
            console.log('Chart.jså·²åŠ è½½ï¼Œåˆå§‹åŒ–å›¾è¡¨');
            
            // åˆå§‹åŒ–å›¾è¡¨
            const ctx = document.getElementById('performanceChart').getContext('2d');
            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: []
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,
                                text: 'æ—¶é—´',
                                font: {
                                    size: 12
                                }
                            }
                        },
                        y: {
                            display: true,
                            title: {
                                display: true,
                                text: 'ç´¯è®¡æ”¶ç›Šç‡ (%)',
                                font: {
                                    size: 12
                                }
                            },
                            ticks: {
                                precision: 2,
                                callback: function(value) {
                                    return value.toFixed(2) + '%';
                                }
                            },
                            beginAtZero: false,
                            grace: '10%'
                        }
                    },
                    animation: {
                        duration: 500
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'AIæ¨¡å‹æ”¶ç›Šç‡å¯¹æ¯”',
                            font: {
                                size: 14,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            position: 'top',
                        }
                    },
                    elements: {
                        line: {
                            tension: 0.4,
                            borderWidth: 2
                        },
                        point: {
                            radius: 4,
                            hoverRadius: 6
                        }
                    }
                }
            });
            
            // æ˜¾ç¤ºå›¾è¡¨å¹¶éšè—åŠ è½½æç¤º
            document.getElementById('chartPlaceholder').style.display = 'none';
            document.getElementById('performanceChart').style.display = 'block';
            
            return chart;
        }
        
        // åˆå§‹åŒ–æ—¥å¿—å®¹å™¨
        function initLogContainer() {
            const logContainer = document.getElementById('logContainer');
            return logContainer;
        }
        
        // æ·»åŠ æ—¥å¿—æ¡ç›®
        function addLogEntry(logContainer, logEntry) {
            try {
                const logDiv = document.createElement('div');
                logDiv.className = 'log-entry';
                
                const timestamp = logEntry.timestamp || new Date().toISOString();
                const level = logEntry.level || 'INFO';
                const message = logEntry.message || '';
                
                logDiv.innerHTML = `
                    <span class="timestamp">${timestamp}</span>
                    <span class="level ${level}">${level}</span>
                    <span class="message">${message}</span>
                `;
                logContainer.appendChild(logDiv);
                logContainer.scrollTop = logContainer.scrollHeight;
                
                // é™åˆ¶æ—¥å¿—æ•°é‡
            } catch (error) {
                console.error('Error adding log entry:', error);
            }
        }
        
        // æ›´æ–°æ€§èƒ½å›¾è¡¨
        function updatePerformanceChart(chart, data) {
            if (!chart || !data) return;
            
            // æ¸…ç©ºç°æœ‰æ•°æ®
            chart.data.labels = [];
            chart.data.datasets = [];
            
            // ä¸ºæ¯ä¸ªæ¨¡å‹åˆ›å»ºæ•°æ®é›†
            const colors = [
                'rgb(255, 99, 132)',
                'rgb(54, 162, 235)',
                'rgb(255, 205, 86)',
                'rgb(75, 192, 192)',
                'rgb(153, 102, 255)',
                'rgb(255, 159, 64)'
            ];
            
            let colorIndex = 0;
            let allTimes = [];
            
            // æ”¶é›†æ‰€æœ‰æ—¶é—´ç‚¹
            for (const [modelName, modelData] of Object.entries(data)) {
                if (modelData && Array.isArray(modelData)) {
                    modelData.forEach(point => {
                        if (point.time && !allTimes.includes(point.time)) {
                            allTimes.push(point.time);
                        }
                    });
                }
            }
            
            // æŒ‰æ—¶é—´æ’åº
            allTimes.sort();
            
            // æå–æ—¶é—´æ ‡ç­¾ï¼ˆåªæ˜¾ç¤ºæ—¶é—´éƒ¨åˆ†ï¼‰
            const timeLabels = allTimes.map(timeStr => {
                const date = new Date(timeStr);
                return date.toLocaleTimeString();
            });
            
            chart.data.labels = timeLabels;
            
            // ä¸ºæ¯ä¸ªæ¨¡å‹åˆ›å»ºæ•°æ®é›†
            for (const [modelName, modelData] of Object.entries(data)) {
                if (modelData && Array.isArray(modelData)) {
                    const color = colors[colorIndex % colors.length];
                    colorIndex++;
                    
                    // åˆ›å»ºä¸æ—¶é—´æ ‡ç­¾å¯¹é½çš„æ”¶ç›Šç‡æ•°æ®
                    const profits = [];
                    const timeMap = {};
                    
                    // å»ºç«‹æ—¶é—´åˆ°æ”¶ç›Šç‡çš„æ˜ å°„
                    modelData.forEach(point => {
                        timeMap[point.time] = point.profit;
                    });
                    
                    // æ ¹æ®æ—¶é—´æ ‡ç­¾å¡«å……æ”¶ç›Šç‡æ•°æ®
                    allTimes.forEach(timeStr => {
                        const profitValue = timeMap[timeStr];
                        if (profitValue !== undefined) {
                            const numValue = typeof profitValue === 'string' ? parseFloat(profitValue) : Number(profitValue);
                            profits.push(isNaN(numValue) ? null : numValue);
                        } else {
                            profits.push(null);
                        }
                    });
                    
                    const dataset = {
                        label: modelName,
                        data: profits,
                        borderColor: color,
                        backgroundColor: color.replace(')', ', 0.1)').replace('rgb', 'rgba'),
                        fill: false,
                        tension: 0.4,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    };
                    
                    chart.data.datasets.push(dataset);
                }
            }
            
            // å¼ºåˆ¶æ›´æ–°å›¾è¡¨
            chart.update('active');
        }
        
        // HTTPè½®è¯¢è·å–æ•°æ®ï¼ˆGitHub Pages çš„ä¸»è¦æ•°æ®è·å–æ–¹å¼ï¼‰
        function fetchPerformanceData() {
            // å¦‚æœ Socket.IO å¯ç”¨ï¼Œè·³è¿‡ HTTP è½®è¯¢ï¼ˆç”± Socket.IO æ¨é€ï¼‰
            if (useSocketIO && socket && socket.connected) {
                return;
            }
            
            const url = `${API_BASE}/api/performance`;
            fetch(url, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Cache-Control': 'no-cache, no-store, must-revalidate',
                    'Pragma': 'no-cache',
                    'Expires': '0'
                },
                cache: 'no-store'
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    if (chart) {
                        updatePerformanceChart(chart, data);
                    }
                })
                .catch(error => {
                    console.error('âŒ è·å–æ€§èƒ½æ•°æ®å¤±è´¥:', error.message);
                });
        }
        
        // æ³¨å†Œ Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./sw.js')
                    .then(function(registration) {
                        console.log('âœ… Service Worker æ³¨å†ŒæˆåŠŸ:', registration.scope);
                        // æ£€æŸ¥æ˜¯å¦æœ‰æ›´æ–°
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    console.log('ğŸ”„ å‘ç° Service Worker æ›´æ–°ï¼Œå°†åœ¨åˆ·æ–°åç”Ÿæ•ˆ');
                                }
                            });
                        });
                    })
                    .catch(function(error) {
                        console.warn('âš ï¸ Service Worker æ³¨å†Œå¤±è´¥:', error);
                    });
                
                // ç›‘å¬ Service Worker æ§åˆ¶æƒå˜æ›´
                let refreshing = false;
                navigator.serviceWorker.addEventListener('controllerchange', () => {
                    if (!refreshing) {
                        refreshing = true;
                        console.log('ğŸ”„ Service Worker å·²æ›´æ–°ï¼Œåˆ·æ–°é¡µé¢...');
                        // å¯é€‰ï¼šè‡ªåŠ¨åˆ·æ–°é¡µé¢ä»¥ä½¿ç”¨æ–°çš„ Service Worker
                        // window.location.reload();
                    }
                });
            });
        }
        
        // å¯åŠ¨åˆå§‹åŒ–è¿‡ç¨‹
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–å›¾è¡¨
            const chartInitInterval = setInterval(() => {
                const newChart = initChart();
                if (newChart) {
                    chart = newChart;
                    clearInterval(chartInitInterval);
                    console.log('å›¾è¡¨åˆå§‹åŒ–å®Œæˆ');
                    // åˆå§‹åŒ–åç«‹å³è·å–ä¸€æ¬¡æ•°æ®
                    fetchPerformanceData();
                    // å¼€å§‹å®šæ—¶è½®è¯¢ï¼ˆæ¯10ç§’ï¼‰
                    // æ³¨æ„ï¼šå¦‚æœ Socket.IO è¿æ¥æˆåŠŸï¼ŒHTTP è½®è¯¢ä¼šè¢«è·³è¿‡
                    setInterval(fetchPerformanceData, 10000);
                }
            }, 1000);
            
            // æ·»åŠ åˆ‡æ¢æ˜¾ç¤ºæ•°æ®çš„æŒ‰é’®äº‹ä»¶ç›‘å¬å™¨
            let showFullData = false;
            const toggleButton = document.getElementById('toggleDataButton');
            if (toggleButton) {
                toggleButton.addEventListener('click', function() {
                    showFullData = !showFullData;
                    toggleButton.textContent = showFullData ? 'æ˜¾ç¤ºæœ€è¿‘æ•°æ®' : 'æ˜¾ç¤ºå…¨éƒ¨æ•°æ®';
                    
                    const url = showFullData ? `${API_BASE}/api/performance_full` : `${API_BASE}/api/performance`;
                    fetch(url)
                        .then(response => response.json())
                        .then(data => {
                            if (chart) {
                                updatePerformanceChart(chart, data);
                            }
                        })
                        .catch(error => {
                            console.error('Failed to load performance data:', error);
                        });
                });
            }
            
            // åˆå§‹åŒ–æ—¥å¿—å®¹å™¨
            const logContainer = initLogContainer();
            
            // Socket.IO äº‹ä»¶ç›‘å¬å·²åœ¨ä¸Šé¢åˆå§‹åŒ–æ—¶è®¾ç½®ï¼Œè¿™é‡Œä¸éœ€è¦é‡å¤è®¾ç½®
            // ä½†æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€äº›é¢å¤–çš„ç›‘å¬å™¨ç”¨äºè°ƒè¯•
            if (socket) {
                // å¦‚æœè¿æ¥æˆåŠŸï¼Œç­‰å¾…å›¾è¡¨åˆå§‹åŒ–åè·å–ä¸€æ¬¡åˆå§‹æ•°æ®
                socket.on('connect', function() {
                    const waitForChart = setInterval(() => {
                        if (chart) {
                            clearInterval(waitForChart);
                            // Socket.IO è¿æ¥æˆåŠŸæ—¶ï¼Œåˆå§‹æ•°æ®ä¼šé€šè¿‡ performance_update äº‹ä»¶æ¨é€
                            // ä½†ä¸ºäº†ç¡®ä¿ï¼Œæˆ‘ä»¬ä¹Ÿä¸»åŠ¨è·å–ä¸€æ¬¡
                            if (!useSocketIO) {
                                fetchPerformanceData();
                            }
                        }
                    }, 100);
                    setTimeout(() => clearInterval(waitForChart), 5000);
                });
            }
            
            // é¡µé¢åŠ è½½æ—¶è·å–åˆå§‹æ—¥å¿—ï¼ˆå®Œå…¨å®æ—¶ï¼Œä¸ç¼“å­˜ï¼‰
            let lastLogPollTime = Date.now();
            let lastLogCount = 0;
            window.onload = function() {
                fetch(`${API_BASE}/api/logs`)
                    .then(response => response.json())
                    .then(logs => {
                        if (Array.isArray(logs)) {
                            logs.forEach(log => addLogEntry(logContainer, log));
                            lastLogCount = logs.length;
                        }
                    })
                    .catch(error => {
                        console.error('Failed to load logs:', error);
                    });
            };
            
            // å¤‡ç”¨è½®è¯¢æœºåˆ¶ï¼šæ¯5ç§’æ£€æŸ¥ä¸€æ¬¡æ˜¯å¦æœ‰æ–°æ—¥å¿—ï¼ˆå¦‚æœSocketIOæ–­å¼€ï¼‰
            setInterval(function() {
                // å¦‚æœSocketIOæ–­å¼€è¶…è¿‡5ç§’ï¼Œå¯ç”¨è½®è¯¢
                const timeSinceLastLog = Date.now() - lastLogPollTime;
                if (socket && !socket.connected && timeSinceLastLog > 5000) {
                    fetch(`${API_BASE}/api/logs`)
                        .then(response => response.json())
                        .then(logs => {
                            // åªæ·»åŠ æ–°æ—¥å¿—ï¼ˆæ ¹æ®æ•°é‡åˆ¤æ–­ï¼‰
                            if (Array.isArray(logs) && logs.length > lastLogCount) {
                                const newLogs = logs.slice(lastLogCount);
                                newLogs.forEach(log => addLogEntry(logContainer, log));
                                lastLogCount = logs.length;
                            }
                            lastLogPollTime = Date.now();
                        })
                        .catch(error => {
                            console.error('Failed to poll logs:', error);
                        });
                }
            }, 5000); // æ¯5ç§’æ£€æŸ¥ä¸€æ¬¡
        });
    </script>
</body>
</html>
